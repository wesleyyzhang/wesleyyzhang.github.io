<!DOCTYPE html>
<html>
  <head>
    <title>CS 180 Proj 3</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        /* Flexbox container for side-by-side images */
        .side-by-side {
            display: flex;
            justify-content: space-between; 
            margin: 20px 0; 
        }
        .side-by-side .image-box {
            text-align: center; 
        }
        .side-by-side img {
            width: 250px; 
            height: auto; 
        }
        .image-box img {
          height: 500px;
          width: auto;
        }
        .long {
          display: flex;
        }
        .long_box img {
          width: 5000px;
          height: auto;
        }
        .bballs {
          height: 300px;
          width: auto;
        }
        .bball {
          display: flex;
        }
    </style>
  </head>

  <body>
    <h1>CS 180 Proj 3: Face Morphing</h1>

    <h2>Part 1: Defining Correspondences</h2>

    <p>
      First, I defined pairs of corresponding points for the two images using the correspondence tool from the CS180 website. In order to lessen the potential for 
      triangle deformations, I took the average of the two sets of points and used the averaged set to create the Delaunay triangulation. I have displayed both 
      of the images I will use for the face morphing along with their respective keypoints below:
      
    </p>

    <div class="image-box">
          <h3>Delauney Triangulation of Both Images</h3>
          <img src="media/delauney.jpg" alt="Monastery Image">
    </div>
    

    <h2>Part 2: Computing the "Mid-Way" Face</h2>

    <p>
      Before computing the entire morph sequence for the two faces, I computed the average face between the two faces. In order to do this, I performed the following steps:
      1. I first computed the average shape using the average of each keypoint location in the two faces. 
      
      2. I then warped both faces into the average shape. To do this, I defined the function computeAffine(tri1_pts,tri2_pts) to 
      compute affine transformation matrices A between two triangles from each of the images. This transformation matrix was then used to implement an inverse warp of all pixels.
      I used sk.draw.polygon to find all points within a given triangle and applied the inverse transformation matrix to the points. 
      
      3. Lastly, I averaged the colors of the two faces together using a dissolve fraction of 0.5. 
    </p>

    <div class="side-by-side">
      <div class="image-box">
            <h3>Wesley Image</h3>
            <img src="media/wesley2-2.jpg" alt="Monastery Image">
      </div>
      <div class="image-box">
            <h3>Wesley Jeremy Midway Image</h3>
            <img src="media/wesleyjeremymidway.jpg" alt="Monastery no crop Image">
      </div>
      <div class="image-box">
            <h3>Jeremy Image</h3>
            <img src="media/jeremylin-2.jpg" alt="Monastery no crop Image">
      </div>
    </div>
    

    <h2>Part 3: The Morph Sequence</h2>

    <div class="image-box">
          <h3>Wesley Jeremy Frames</h3>
          <img src="media/frames.jpg" alt="Monastery Image">
    </div>
    
    <div class="image-box">
          <h3>Wesley Jeremy Gif</h3>
          <img src="media/wesleyjeremyloop.gif" alt="Monastery Image">
    </div>
    

    <h2>Part 4: The "Mean face" of a population</h2>

    <div class="side-by-side">
      <div class="image-box">
            <h3>Average Person</h3>
            <img src="media/average_face.jpg" alt="Monastery Image">
      </div>
      <div class="image-box">
            <h3>Average Smiling Person</h3>
            <img src="media/averageface.jpg" alt="Monastery no crop Image">
      </div>
    </div>

    <div class="image-box">
          <h3>Warped Male</h3>
          <img src="media/warpedperson.jpg" alt="Monastery Image">
    </div>

    <div class="image-box">
          <h3>Warped Female</h3>
          <img src="media/femalewarptoaverage.jpg" alt="Monastery Image">
    </div>

    <div class="image-box">
          <h3>My Face Warped to Average Face</h3>
          <img src="media/warpedwesley.jpg" alt="Monastery Image">
    </div>

    <div class="image-box">
          <h3>Average Face Warped to My Face</h3>
          <img src="media/averagewarpedtowesley.jpg" alt="Monastery Image">
    </div>

    
    <h2>Part 5: Caricatures: Extrapolating from the mean</h2>

    <div class="image-box">
          <h3>Caricature of My Face</h3>
          <img src="media/Caricature.jpg" alt="Monastery Image">
    </div>

    <h2>Bells and Whistles: Changing Ethnicity</h2>

    <div class="side-by-side">
      <div class="image-box">
            <h3>Image of My Face</h3>
            <img src="media/wesley2-2.jpg" alt="Monastery Image">
      </div>
      <div class="image-box">
            <h3>Image of Average English Man Face</h3>
            <img src="media/averageeurope-2.jpg" alt="Monastery no crop Image">
      </div>
    </div>

    <div class="image-box">
          <h3>Morphing My Shape to Average English Face</h3>
          <img src="media/warpedwesleyeurope.jpg" alt="Monastery Image">
    </div>

    <div class="image-box">
          <h3>Morphing My Appearance to Average English Face</h3>
          <img src="media/europeappearancewesley.jpg" alt="Monastery Image">
    </div>

    <div class="image-box">
          <h3>Morphing Both Shape and Appearance to Average English Face</h3>
          <img src="media/warpedappearancewesley.jpg" alt="Monastery Image">
    </div>
    
  </body>
</html>
